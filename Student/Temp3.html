
CREATE TABLE lesson_games (
    game_id INT AUTO_INCREMENT PRIMARY KEY,
    lesson_id INT NOT NULL,
    questions JSON NOT NULL,
    passing_score INT NOT NULL DEFAULT 70,
    FOREIGN KEY (lesson_id) REFERENCES lesson(lesson_id) ON DELETE CASCADE
);




-- Create progress tracking table
CREATE TABLE user_game_progress (
    progress_id INT AUTO_INCREMENT PRIMARY KEY,
    stu_id INT NOT NULL,
    game_id INT NOT NULL,
    score INT NOT NULL,
    completed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (stu_id) REFERENCES students(stu_id) ON DELETE CASCADE,
    FOREIGN KEY (game_id) REFERENCES lesson_games(game_id) ON DELETE CASCADE
);

-- Sample game data insertion
INSERT INTO lesson_games (lesson_id, questions, passing_score) 
VALUES (
    12,  -- lesson_id
    '{
        "true_false": [
            {
                "question": "Programming is just writing text on paper without needing to understand logic.",
                "correctAnswer": false,
                "hint": "Programming requires logical thinking to solve problems!"
            },
            {
                "question": "The teacher compares programming to a puzzle game.",
                "correctAnswer": true,
                "hint": "Both involve putting pieces together in the right way"
            }
        ],
        "multiple_choice": [
            {
                "question": "What is the main benefit of logical thinking in programming?",
                "options": [
                    "Decorating the user interface",
                    "Organizing solution steps correctly",
                    "Just memorizing code",
                    "Writing reports"
                ],
                "correctIndex": 1,
                "hint1": "Think about how to solve problems step by step",
                "hint2": "It's like giving clear instructions to a friend"
            }
        ],
        "multi_select": [
            {
                "question": "What are the educational benefits of kids programming?",
                "options": [
                    "Developing logical thinking",
                    "Improving only creative writing skills",
                    "Enhancing problem solving",
                    "Increasing distraction"
                ],
                "correctIndices": [0, 2],
                "hint": "Programming helps build important thinking skills"
            }
        ]
    }',
    70  -- passing score
);